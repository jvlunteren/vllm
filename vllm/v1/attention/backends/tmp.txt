On branch jvl-hybrid-support
Your branch is up to date with 'origin/jvl-hybrid-support'.

All conflicts fixed but you are still merging.
  (use "git commit" to conclude merge)

Changes to be committed:
	modified:   ../../../../.buildkite/scripts/hardware_ci/run-amd-test.sh
	modified:   ../../../../.buildkite/scripts/hardware_ci/run-cpu-test.sh
	modified:   ../../../../.buildkite/test-pipeline.yaml
	modified:   ../../../../.github/CODEOWNERS
	modified:   ../../../../.github/ISSUE_TEMPLATE/750-RFC.yml
	modified:   ../../../../.github/mergify.yml
	modified:   ../../../../RELEASE.md
	new file:   ../../../../benchmarks/auto_tune/README.md
	renamed:    ../../../../benchmarks/auto_tune.sh -> ../../../../benchmarks/auto_tune/auto_tune.sh
	modified:   ../../../../benchmarks/kernels/benchmark_moe.py
	modified:   ../../../../benchmarks/kernels/benchmark_moe_align_block_size.py
	modified:   ../../../../benchmarks/kernels/benchmark_moe_permute_unpermute.py
	new file:   ../../../../benchmarks/kv_cache/benchmark_block_pool.py
	modified:   ../../../../csrc/cpu/shm.cpp
	modified:   ../../../../csrc/moe/moe_align_sum_kernels.cu
	modified:   ../../../../csrc/quantization/cutlass_w8a8/moe/grouped_mm_c3x.cu
	modified:   ../../../../csrc/quantization/cutlass_w8a8/moe/grouped_mm_c3x.cuh
	modified:   ../../../../csrc/quantization/cutlass_w8a8/moe/moe_data.cu
	modified:   ../../../../csrc/torch_bindings.cpp
	modified:   ../../../../docker/Dockerfile
	modified:   ../../../../docker/Dockerfile.xpu
	modified:   ../../../../docs/configuration/model_resolution.md
	modified:   ../../../../docs/design/v1/metrics.md
	modified:   ../../../../docs/features/lora.md
	modified:   ../../../../docs/features/multimodal_inputs.md
	modified:   ../../../../docs/features/quantization/bitblas.md
	modified:   ../../../../docs/features/quantization/fp8.md
	modified:   ../../../../docs/features/quantization/int4.md
	modified:   ../../../../docs/features/quantization/int8.md
	modified:   ../../../../docs/features/tool_calling.md
	modified:   ../../../../docs/getting_started/installation/cpu.md
	modified:   ../../../../docs/models/extensions/tensorizer.md
	modified:   ../../../../docs/models/pooling_models.md
	modified:   ../../../../docs/models/supported_models.md
	modified:   ../../../../docs/usage/v1_guide.md
	modified:   ../../../../examples/offline_inference/basic/classify.py
	modified:   ../../../../examples/offline_inference/basic/embed.py
	modified:   ../../../../examples/offline_inference/basic/score.py
	modified:   ../../../../examples/offline_inference/embed_jina_embeddings_v3.py
	modified:   ../../../../examples/offline_inference/embed_matryoshka_fy.py
	modified:   ../../../../examples/offline_inference/neuron_eagle.py
	modified:   ../../../../examples/offline_inference/neuron_speculation.py
	modified:   ../../../../examples/offline_inference/prithvi_geospatial_mae.py
	modified:   ../../../../examples/offline_inference/qwen3_reranker.py
	new file:   ../../../../examples/online_serving/elastic_ep/bench.sh
	new file:   ../../../../examples/online_serving/elastic_ep/scale.py
	new file:   ../../../../examples/online_serving/elastic_ep/serve_deepseek_v2.sh
	modified:   ../../../../pyproject.toml
	modified:   ../../../../requirements/cpu.txt
	modified:   ../../../../tests/basic_correctness/test_basic_correctness.py
	modified:   ../../../../tests/basic_correctness/test_preemption.py
	modified:   ../../../../tests/conftest.py
	modified:   ../../../../tests/core/test_num_computed_tokens_update.py
	modified:   ../../../../tests/core/test_serialization.py
	modified:   ../../../../tests/core/utils.py
	modified:   ../../../../tests/detokenizer/test_stop_reason.py
	modified:   ../../../../tests/detokenizer/test_stop_strings.py
	modified:   ../../../../tests/entrypoints/llm/test_accuracy.py
	modified:   ../../../../tests/entrypoints/openai/test_cli_args.py
	deleted:    ../../../../tests/kernels/attention/test_blocksparse_attention.py
	modified:   ../../../../tests/kernels/attention/test_flashinfer.py
	modified:   ../../../../tests/kernels/attention/test_rocm_attention_selector.py
	modified:   ../../../../tests/kernels/moe/test_cutlass_moe.py
	modified:   ../../../../tests/kernels/moe/test_moe_align_block_size.py
	modified:   ../../../../tests/lora/conftest.py
	modified:   ../../../../tests/lora/test_llama_tp.py
	modified:   ../../../../tests/lora/test_peft_helper.py
	modified:   ../../../../tests/metrics/test_metrics.py
	modified:   ../../../../tests/model_executor/test_guided_processors.py
	modified:   ../../../../tests/model_executor/test_model_load_with_params.py
	modified:   ../../../../tests/models/language/generation/test_hybrid.py
	modified:   ../../../../tests/models/language/generation/test_mistral.py
	modified:   ../../../../tests/models/language/pooling/mteb_utils.py
	modified:   ../../../../tests/models/language/pooling/test_gritlm.py
	modified:   ../../../../tests/models/language/pooling/test_jina.py
	modified:   ../../../../tests/models/language/pooling/test_nomic_max_model_len.py
	modified:   ../../../../tests/models/language/pooling/test_truncation_control.py
	modified:   ../../../../tests/models/multimodal/generation/test_common.py
	new file:   ../../../../tests/models/multimodal/generation/test_maverick.py
	modified:   ../../../../tests/models/multimodal/generation/test_pixtral.py
	modified:   ../../../../tests/models/multimodal/generation/test_whisper.py
	modified:   ../../../../tests/models/multimodal/generation/vlm_utils/core.py
	modified:   ../../../../tests/models/multimodal/pooling/test_dse_qwen2_vl.py
	modified:   ../../../../tests/models/multimodal/pooling/test_jinavl_reranker.py
	modified:   ../../../../tests/models/quantization/test_modelopt.py
	modified:   ../../../../tests/models/quantization/test_nvfp4.py
	modified:   ../../../../tests/models/registry.py
	modified:   ../../../../tests/models/test_initialization.py
	modified:   ../../../../tests/models/test_registry.py
	modified:   ../../../../tests/models/test_transformers.py
	modified:   ../../../../tests/multimodal/test_video.py
	modified:   ../../../../tests/multimodal/utils.py
	modified:   ../../../../tests/plugins/vllm_add_dummy_model/vllm_add_dummy_model/my_gemma_embedding.py
	modified:   ../../../../tests/prefix_caching/test_disable_sliding_window.py
	modified:   ../../../../tests/prefix_caching/test_prefix_caching.py
	modified:   ../../../../tests/quantization/test_gptq_dynamic.py
	new file:   ../../../../tests/quantization/test_modelopt.py
	modified:   ../../../../tests/quantization/test_quark.py
	modified:   ../../../../tests/quantization/test_register_quantization_config.py
	modified:   ../../../../tests/samplers/test_ignore_eos.py
	modified:   ../../../../tests/samplers/test_logits_processor.py
	modified:   ../../../../tests/samplers/test_logprobs.py
	modified:   ../../../../tests/samplers/test_no_bad_words.py
	deleted:    ../../../../tests/samplers/test_rejection_sampler.py
	modified:   ../../../../tests/samplers/test_seeded_generate.py
	deleted:    ../../../../tests/samplers/test_typical_acceptance_sampler.py
	deleted:    ../../../../tests/spec_decode/conftest.py
	deleted:    ../../../../tests/spec_decode/e2e/__init__.py
	deleted:    ../../../../tests/spec_decode/e2e/conftest.py
	deleted:    ../../../../tests/spec_decode/e2e/test_compatibility.py
	deleted:    ../../../../tests/spec_decode/e2e/test_eagle_correctness.py
	deleted:    ../../../../tests/spec_decode/e2e/test_integration.py
	deleted:    ../../../../tests/spec_decode/e2e/test_integration_dist_tp2.py
	deleted:    ../../../../tests/spec_decode/e2e/test_integration_dist_tp4.py
	deleted:    ../../../../tests/spec_decode/e2e/test_logprobs.py
	deleted:    ../../../../tests/spec_decode/e2e/test_medusa_correctness.py
	deleted:    ../../../../tests/spec_decode/e2e/test_mlp_correctness.py
	deleted:    ../../../../tests/spec_decode/e2e/test_mtp_correctness.py
	deleted:    ../../../../tests/spec_decode/e2e/test_multistep_correctness.py
	deleted:    ../../../../tests/spec_decode/e2e/test_ngram_correctness.py
	deleted:    ../../../../tests/spec_decode/e2e/test_seed.py
	deleted:    ../../../../tests/spec_decode/test_batch_expansion.py
	deleted:    ../../../../tests/spec_decode/test_dynamic_spec_decode.py
	deleted:    ../../../../tests/spec_decode/test_memory_usage.py
	deleted:    ../../../../tests/spec_decode/test_metrics.py
	deleted:    ../../../../tests/spec_decode/test_multi_step_worker.py
	deleted:    ../../../../tests/spec_decode/test_ngram_worker.py
	deleted:    ../../../../tests/spec_decode/test_scorer.py
	deleted:    ../../../../tests/spec_decode/test_spec_decode_worker.py
	deleted:    ../../../../tests/spec_decode/test_utils.py
	deleted:    ../../../../tests/spec_decode/utils.py
	modified:   ../../../../tests/test_sequence.py
	modified:   ../../../../tests/test_utils.py
	modified:   ../../../../tests/tokenization/test_detokenize.py
	new file:   ../../../../tests/tokenization/test_do_lower_case.py
	new file:   ../../../../tests/tool_use/test_glm4_moe_tool_parser.py
	modified:   ../../../../tests/v1/core/test_kv_cache_utils.py
	modified:   ../../../../tests/v1/core/test_prefix_caching.py
	modified:   ../../../../tests/v1/core/test_scheduler_e2e.py
	modified:   ../../../../tests/v1/core/test_specialized_manager.py
	modified:   ../../../../tests/v1/engine/test_async_llm.py
	modified:   ../../../../tests/v1/engine/test_llm_engine.py
	modified:   ../../../../tests/v1/kv_connector/unit/test_nixl_connector.py
	renamed:    ../../../../tests/v1/executor/test_multiproc_executor.py -> ../../../../tests/v1/kv_connector/unit/test_output_aggreagator.py
	modified:   ../../../../tests/v1/metrics/test_ray_metrics.py
	modified:   ../../../../tests/v1/sample/test_logprobs.py
	modified:   ../../../../tests/v1/sample/test_sampling_params_e2e.py
	modified:   ../../../../tests/v1/test_async_llm_dp.py
	modified:   ../../../../tests/v1/test_oracle.py
	modified:   ../../../../tests/v1/tpu/test_pallas.py
	new file:   ../../../../tools/ep_kernels/elastic_ep/eep_nvshmem.patch
	new file:   ../../../../tools/ep_kernels/elastic_ep/install_eep_libraries.sh
	modified:   ../../../../tools/mypy.sh
	modified:   ../../../_custom_ops.py
	modified:   ../../../assets/video.py
	modified:   ../../../attention/backends/abstract.py
	deleted:    ../../../attention/backends/blocksparse_attn.py
	modified:   ../../../attention/backends/differential_flash_attn.py
	modified:   ../../../attention/backends/dual_chunk_flash_attn.py
	modified:   ../../../attention/backends/flash_attn.py
	modified:   ../../../attention/backends/flashinfer.py
	modified:   ../../../attention/backends/flashmla.py
	modified:   ../../../attention/backends/mla/common.py
	modified:   ../../../attention/backends/rocm_aiter_mla.py
	modified:   ../../../attention/backends/rocm_flash_attn.py
	modified:   ../../../attention/backends/triton_mla.py
	modified:   ../../../attention/backends/xformers.py
	modified:   ../../../attention/layer.py
	deleted:    ../../../attention/ops/blocksparse_attention/__init__.py
	deleted:    ../../../attention/ops/blocksparse_attention/blocksparse_attention_kernel.py
	deleted:    ../../../attention/ops/blocksparse_attention/interface.py
	deleted:    ../../../attention/ops/blocksparse_attention/utils.py
	modified:   ../../../attention/ops/rocm_aiter_mla.py
	modified:   ../../../attention/selector.py
	modified:   ../../../benchmarks/serve.py
	modified:   ../../../config.py
	modified:   ../../../distributed/device_communicators/cpu_communicator.py
	modified:   ../../../distributed/eplb/eplb_state.py
	modified:   ../../../distributed/eplb/rebalance_execute.py
	modified:   ../../../distributed/kv_transfer/kv_connector/utils.py
	modified:   ../../../distributed/kv_transfer/kv_connector/v1/base.py
	modified:   ../../../distributed/parallel_state.py
	modified:   ../../../engine/arg_utils.py
	modified:   ../../../engine/llm_engine.py
	modified:   ../../../engine/metrics.py
	modified:   ../../../engine/metrics_types.py
	modified:   ../../../engine/output_processor/multi_step.py
	modified:   ../../../engine/protocol.py
	modified:   ../../../entrypoints/llm.py
	modified:   ../../../entrypoints/openai/api_server.py
	modified:   ../../../entrypoints/openai/cli_args.py
	modified:   ../../../entrypoints/openai/protocol.py
	modified:   ../../../entrypoints/openai/serving_classification.py
	modified:   ../../../entrypoints/openai/serving_embedding.py
	modified:   ../../../entrypoints/openai/serving_engine.py
	modified:   ../../../entrypoints/openai/serving_pooling.py
	modified:   ../../../entrypoints/openai/serving_score.py
	modified:   ../../../entrypoints/openai/tool_parsers/__init__.py
	new file:   ../../../entrypoints/openai/tool_parsers/glm4_moe_tool_parser.py
	modified:   ../../../envs.py
	modified:   ../../../executor/executor_base.py
	modified:   ../../../executor/uniproc_executor.py
	modified:   ../../../lora/layers.py
	modified:   ../../../lora/models.py
	modified:   ../../../lora/peft_helper.py
	modified:   ../../../lora/punica_wrapper/punica_base.py
	modified:   ../../../lora/punica_wrapper/punica_gpu.py
	modified:   ../../../lora/punica_wrapper/punica_tpu.py
	modified:   ../../../lora/punica_wrapper/utils.py
	modified:   ../../../lora/utils.py
	modified:   ../../../lora/worker_manager.py
	renamed:    ../../../../tests/spec_decode/__init__.py -> ../../../mocks/__init__.py
	new file:   ../../../mocks/mock_nixl_connector.py
	modified:   ../../../model_executor/layers/fused_moe/batched_deep_gemm_moe.py
	modified:   ../../../model_executor/layers/fused_moe/batched_triton_or_deep_gemm_moe.py
	modified:   ../../../model_executor/layers/fused_moe/config.py
	modified:   ../../../model_executor/layers/fused_moe/cutlass_moe.py
	modified:   ../../../model_executor/layers/fused_moe/deep_gemm_moe.py
	modified:   ../../../model_executor/layers/fused_moe/deepep_ht_prepare_finalize.py
	modified:   ../../../model_executor/layers/fused_moe/deepep_ll_prepare_finalize.py
	new file:   ../../../model_executor/layers/fused_moe/flashinfer_cutlass_moe.py
	new file:   ../../../model_executor/layers/fused_moe/flashinfer_cutlass_prepare_finalize.py
	modified:   ../../../model_executor/layers/fused_moe/fused_batched_moe.py
	modified:   ../../../model_executor/layers/fused_moe/fused_moe.py
	modified:   ../../../model_executor/layers/fused_moe/layer.py
	modified:   ../../../model_executor/layers/fused_moe/modular_kernel.py
	modified:   ../../../model_executor/layers/fused_moe/moe_align_block_size.py
	modified:   ../../../model_executor/layers/fused_moe/pplx_prepare_finalize.py
	modified:   ../../../model_executor/layers/fused_moe/prepare_finalize.py
	modified:   ../../../model_executor/layers/fused_moe/triton_deep_gemm_moe.py
	modified:   ../../../model_executor/layers/fused_moe/utils.py
	modified:   ../../../model_executor/layers/mamba/mamba_mixer2.py
	modified:   ../../../model_executor/layers/pooler.py
	modified:   ../../../model_executor/layers/quantization/compressed_tensors/compressed_tensors_moe.py
	modified:   ../../../model_executor/layers/quantization/fp8.py
	modified:   ../../../model_executor/layers/quantization/modelopt.py
	deleted:    ../../../model_executor/layers/rejection_sampler.py
	modified:   ../../../model_executor/layers/sampler.py
	deleted:    ../../../model_executor/layers/spec_decode_base_sampler.py
	deleted:    ../../../model_executor/layers/typical_acceptance_sampler.py
	modified:   ../../../model_executor/model_loader/utils.py
	modified:   ../../../model_executor/models/adapters.py
	modified:   ../../../model_executor/models/bailing_moe.py
	modified:   ../../../model_executor/models/bamba.py
	modified:   ../../../model_executor/models/bart.py
	modified:   ../../../model_executor/models/bert.py
	modified:   ../../../model_executor/models/deepseek_v2.py
	deleted:    ../../../model_executor/models/eagle.py
	modified:   ../../../model_executor/models/ernie45_moe.py
	new file:   ../../../model_executor/models/exaone4.py
	modified:   ../../../model_executor/models/falcon_h1.py
	modified:   ../../../model_executor/models/gemma.py
	new file:   ../../../model_executor/models/glm4_moe.py
	new file:   ../../../model_executor/models/glm4_moe_mtp.py
	modified:   ../../../model_executor/models/gpt2.py
	modified:   ../../../model_executor/models/granitemoe.py
	modified:   ../../../model_executor/models/granitemoehybrid.py
	modified:   ../../../model_executor/models/granitemoeshared.py
	modified:   ../../../model_executor/models/gritlm.py
	modified:   ../../../model_executor/models/grok1.py
	modified:   ../../../model_executor/models/hunyuan_v1_moe.py
	modified:   ../../../model_executor/models/interfaces.py
	modified:   ../../../model_executor/models/internlm2.py
	modified:   ../../../model_executor/models/jamba.py
	modified:   ../../../model_executor/models/jina_vl.py
	modified:   ../../../model_executor/models/llama.py
	modified:   ../../../model_executor/models/mamba2.py
	modified:   ../../../model_executor/models/modernbert.py
	modified:   ../../../model_executor/models/nemotron_h.py
	deleted:    ../../../model_executor/models/phi3_small.py
	modified:   ../../../model_executor/models/qwen2.py
	modified:   ../../../model_executor/models/qwen2_rm.py
	modified:   ../../../model_executor/models/qwen3.py
	modified:   ../../../model_executor/models/registry.py
	modified:   ../../../model_executor/models/roberta.py
	modified:   ../../../model_executor/models/transformers.py
	modified:   ../../../model_executor/models/zamba2.py
	modified:   ../../../model_executor/pooling_metadata.py
	modified:   ../../../platforms/cpu.py
	modified:   ../../../platforms/cuda.py
	modified:   ../../../platforms/interface.py
	modified:   ../../../platforms/rocm.py
	modified:   ../../../platforms/tpu.py
	modified:   ../../../pooling_params.py
	modified:   ../../../reasoning/__init__.py
	new file:   ../../../reasoning/glm4_moe_reasoning_parser.py
	modified:   ../../../sequence.py
	deleted:    ../../../spec_decode/__init__.py
	deleted:    ../../../spec_decode/batch_expansion.py
	deleted:    ../../../spec_decode/draft_model_runner.py
	deleted:    ../../../spec_decode/interfaces.py
	deleted:    ../../../spec_decode/medusa_worker.py
	deleted:    ../../../spec_decode/metrics.py
	deleted:    ../../../spec_decode/mlp_speculator_worker.py
	deleted:    ../../../spec_decode/mqa_scorer.py
	deleted:    ../../../spec_decode/multi_step_worker.py
	deleted:    ../../../spec_decode/ngram_worker.py
	deleted:    ../../../spec_decode/proposer_worker_base.py
	deleted:    ../../../spec_decode/smaller_tp_proposer_worker.py
	deleted:    ../../../spec_decode/spec_decode_worker.py
	deleted:    ../../../spec_decode/target_model_runner.py
	deleted:    ../../../spec_decode/top1_proposer.py
	deleted:    ../../../spec_decode/util.py
	modified:   ../../../transformers_utils/config.py
	modified:   ../../../transformers_utils/configs/__init__.py
	modified:   ../../../transformers_utils/configs/eagle.py
	new file:   ../../../transformers_utils/configs/exaone4.py
	modified:   ../../../transformers_utils/configs/mistral.py
	modified:   ../../../transformers_utils/tokenizer.py
	modified:   ../../../utils/__init__.py
	modified:   ../../../utils/deep_gemm.py
	new file:   ../../../utils/flashinfer.py
	modified:   cpu_attn.py
	modified:   flash_attn.py
	modified:   flashinfer.py
	modified:   flex_attention.py
	modified:   mla/common.py
	modified:   mla/cutlass_mla.py
	modified:   mla/flashmla.py
	modified:   mla/rocm_aiter_mla.py
	modified:   mla/triton_mla.py
	modified:   pallas.py
	modified:   rocm_aiter_fa.py
	modified:   triton_attn.py
	new file:   triton_attn_new.py
	new file:   triton_attn_org.py
	modified:   utils.py
	modified:   ../../core/kv_cache_utils.py
	modified:   ../../core/single_type_kv_cache_manager.py
	modified:   ../../engine/__init__.py
	modified:   ../../engine/async_llm.py
	modified:   ../../engine/coordinator.py
	modified:   ../../engine/core.py
	modified:   ../../engine/core_client.py
	modified:   ../../engine/utils.py
	modified:   ../../executor/multiproc_executor.py
	modified:   ../../executor/ray_distributed_executor.py
	modified:   ../../kv_cache_interface.py
	modified:   ../../metrics/loggers.py
	modified:   ../../metrics/ray_wrappers.py
	modified:   ../../pool/metadata.py
	modified:   ../../worker/cpu_model_runner.py
	modified:   ../../worker/cpu_worker.py
	modified:   ../../worker/gpu_input_batch.py
	modified:   ../../worker/gpu_model_runner.py
	modified:   ../../worker/gpu_worker.py
	modified:   ../../worker/tpu_model_runner.py
	modified:   ../../worker/tpu_worker.py
	modified:   ../../../worker/model_runner_base.py
	modified:   ../../../worker/pooling_model_runner.py
	modified:   ../../../worker/worker.py
	modified:   ../../../worker/worker_base.py

Untracked files:
  (use "git add <file>..." to include in what will be committed)
	../../../../ShareGPT_V3_unfiltered_cleaned_split.json
	../../../../logs_unif/
	../../../../ref.txt
	../../../../res_dec_128_16.txt
	../../../../res_prompt_128_32.txt
	../../../../res_prompt_256_16.txt
	../../../../res_prompt_32_16.txt
	../../../../run_benchmark_latency_7.py
	../../../../tests/test1.py
	../../../../tests/test2.py
	../../../../tmp.txt
	../../../attention/ops/backup/
	../../../attention/ops/diff.txt
	../../../attention/ops/temp.py
	../../../attention/ops/triton_unified_attention_base.py
	../../../attention/ops/triton_unified_attention_new.py
	../../../attention/ops/triton_unified_attention_org.py
	../../../attention/ops/triton_unified_attention_working.py
	tmp.txt

